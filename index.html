<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Generation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ddd;
        }
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        header img {
            height: 80px;
        }
        .heading {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
        }
        .address {
            font-size: 14px;
            color: gray;
            text-align: center;
            margin-top: -10px;
        }
        .contact {
            text-align: center;
            font-size: 12px;
        }
        .item-list {
            list-style-type: none;
            padding: 0;
            margin: 20px 0;
        }
        .item-list li {
            margin: 10px 0;
            display: flex;
            align-items: center;
        }
        .item-list select {
            margin-left: 10px;
            width: 120px;
        }
        .ads {
            text-align: center;
            margin-top: 20px;
        }
        .ads img {
            width: 100%;
            max-width: 700px;
            height: auto;
        }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #218838;
        }
    #logo{
        border-radius: 50%;
    }
    </style>
</head>
<body>

<div class="container" id="receipt">
    <header>
        <div class="heading">Shopping Receipt</div>
        <img src="data:image/jpeg;base64,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" alt="Logo" id="logo">
    </header>

    <div class="address">1234, Example Street, City, Country - 56789</div>
    <div class="contact">Contact: (123) 456-7890</div>

    <ul class="item-list" id="itemList">
        <!-- Items will be dynamically generated here -->
    </ul>

    <div>
        <button id="generateXLS">Generate Excel</button>
        <button id="generateDOC">Generate Word</button>
        <button id="generatePDF">Generate PDF</button>
        <button id="generateIMG">Generate Image</button>
    </div>

    <div class="ads">
        <img src="https://via.placeholder.com/700x150?text=Advertisement" alt="Advertisement Image" id="adImg">
    </div>
</div>

<script>
    const itemTemplate = [
    { id: 1, name: "Kalash (कलश) / Sacred Pot" },
    { id: 2, name: "Nariyal (नारियल) / Coconut" },
    { id: 3, name: "Deepak (दीपक) / Oil Lamp" },
    { id: 4, name: "Kapoor (कपूर) / Camphor" },
    { id: 5, name: "Agarbatti (अगरबत्ती) / Incense Sticks" },
    { id: 6, name: "Chandan (चंदन) / Sandalwood Paste" },
    { id: 7, name: "Phool Mala (फूल माला) / Flower Garland" },
    { id: 8, name: "Gangajal (गंगाजल) / Holy Water from Ganga" },
    { id: 9, name: "Roli (रोली) / Vermilion" },
    { id: 10, name: "Moli (मौली) / Sacred Thread" },
    { id: 11, name: "Dhoop (धूप) / Incense" },
    { id: 12, name: "Panchamrit (पंचामृत) / Five Holy Ingredients" },
    { id: 13, name: "Kumkum (कुमकुम) / Red Powder" },
    { id: 14, name: "Haldi (हल्दी) / Turmeric" },
    { id: 15, name: "Chawal (चावल) / Rice Grains" },
    { id: 16, name: "Paan Patta (पान पत्ता) / Betel Leaves" },
    { id: 17, name: "Supari (सुपारी) / Betel Nuts" },
    { id: 18, name: "Mishri (मिश्री) / Sugar Crystals" },
    { id: 19, name: "Elaichi (इलायची) / Cardamom" },
    { id: 20, name: "Laddu (लड्डू) / Sweets" },
    { id: 21, name: "Tulsi Patta (तुलसी पत्ता) / Holy Basil Leaves" },
    { id: 22, name: "Ghee (घी) / Clarified Butter" },
    { id: 23, name: "Pooja Thali (पूजा थाली) / Pooja Plate" },
    { id: 24, name: "Sindoor (सिंदूर) / Vermilion Powder" },
    { id: 25, name: "Aarti Bell (आरती घंटी) / Bell for Aarti" },
    { id: 26, name: "Havan Kund (हवन कुंड) / Sacred Fire Pit" },
    { id: 27, name: "Samagri (सामग्री) / Havan Offerings" },
    { id: 28, name: "Flowers (फूल) / Fresh Flowers" },
    { id: 29, name: "Jal Patra (जल पात्र) / Water Pot" },
    { id: 30, name: "Charanamrit (चरणामृत) / Nectar for Blessing" }
];

    const availableQuantities = [100, 250, 500, 1000]; // Quantity options (grams)

    // Dynamically generate the item list
    function generateItemList() {
        const itemList = document.getElementById('itemList');
        itemTemplate.forEach(item => {
            const listItem = document.createElement('li');
            listItem.innerHTML = `
                <input type="checkbox" id="item${item.id}" value="${item.name}"> ${item.name}
                <select id="qty${item.id}">
                    ${availableQuantities.map(qty => `<option value="${qty}">${qty} grams</option>`).join('')}
                </select>
            `;
            itemList.appendChild(listItem);
        });
    }

    // Common function to create the content for various formats
    function createReceiptContent() {
        let content = `
            <html>
                <head>
                    <title>Shopping Receipt</title>
                    <style>
                        body { font-family: Arial, sans-serif; }
                        .heading { text-align: center; font-size: 28px; font-weight: bold; }
                        .address, .contact { text-align: center; font-size: 14px; color: gray; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; }
                    </style>
                </head>
                <body>
                    <center>
                    <p style="color:red; font-size: 10px;"> || Shree Ganeshya Namaha ||</p></center>
                    
                    <br>
                    <div class="heading"><img src="" Aachrya Chandramani Ji Maharaj </div>
                     <div class="address">Naigaion East Mumbai , Maharashtra 401208</div>
                    <div class="contact">Contact: 90982122985 / Dubeychandramani5056@gmail.com</div>

                    <h2>Selected Items</h2>
                    <table>
                        <tr>
                            <th>Item</th>
                            <th>Quantity (g)</th>
                        </tr>`;
        
        itemTemplate.forEach(item => {
            const checkbox = document.getElementById(`item${item.id}`);
            const quantitySelect = document.getElementById(`qty${item.id}`);
            if (checkbox.checked) {
                const quantity = quantitySelect.value;

                content += `
                    <tr>
                        <td>${item.name}</td>
                        <td>${quantity}</td>
                    </tr>`;
            }
        });

        content += `
                    </table>
                </body>
            </html>`;

        return content;
    }

    // Generate PDF receipt
    function generatePDFReceipt() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let y = 20;

        // Add content to the PDF
        doc.html(createReceiptContent(), {
            callback: function (doc) {
                doc.save("shopping_receipt.pdf");
            }
        });
    }

    // Generate Excel file
    function generateExcel() {
        const workbook = XLSX.utils.book_new();
        const worksheetData = [['Item', 'Quantity (g)']];
        
        itemTemplate.forEach(item => {
            const checkbox = document.getElementById(`item${item.id}`);
            const quantitySelect = document.getElementById(`qty${item.id}`);
            if (checkbox.checked) {
                const quantity = quantitySelect.value;
                worksheetData.push([item.name, quantity]);
            }
        });

        const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
        XLSX.utils.book_append_sheet(workbook, worksheet, "Receipt");
        XLSX.writeFile(workbook, "shopping_receipt.xlsx");
    }

    // Generate Word document
    function generateWord() {
        const content = createReceiptContent();
        const blob = new Blob([content], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = "shopping_receipt.doc";
        link.click();
    }

    // Generate image from receipt
    function generateImage() {
        html2canvas(document.getElementById("receipt")).then(canvas => {
            const imgData = canvas.toDataURL("image/png");
            const link = document.createElement("a");
            link.href = imgData;
            link.download = "shopping_receipt.png";
            link.click();
        });
    }

    // Attach events to buttons
    document.getElementById('generateXLS').addEventListener('click', generateExcel);
    document.getElementById('generateDOC').addEventListener('click', generateWord);
    document.getElementById('generatePDF').addEventListener('click', generatePDFReceipt);
    document.getElementById('generateIMG').addEventListener('click', generateImage);

    // Generate the item list on page load
    window.onload = generateItemList;
</script>

</body>
</html>
